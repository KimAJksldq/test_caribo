<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width"
    />
    <link rel="stylesheet" href="./css/card2.css" />
    <title>Ionic Swipe Down</title>
    <link href="./css/card1.css" rel="stylesheet" />
    <script src="./js/jquery.min.js"></script>
    <script src="./js/card1.js"></script>
    <script src="./js/card2.js"></script>
    <script src="./js/card3.js"></script>
    <script>
      $(function () {
        $('td-card').click(function () {
          console.log($(this));
        });
      });
    </script>
  </head>

  <body>
    <div ng-app="starter" no-scroll>
      <ion-pane ng-controller="CardsCtrl">
        <ion-header-bar class="bar-default">
          <h1 class="title">TD Cards</h1>
        </ion-header-bar>

        <td-cards id="tdCards">
          <td-card
            ng-repeat="card in cards"
            on-destroy="cardDestroyed($index)"
            on-swipe-left="cardSwipedLeft($index)"
            on-swipe-right="cardSwipedRight($index)"
            on-partial-swipe="cardPartialSwipe(amt)"
            class="card-{{$index}}"
          >
            <div class="image" ng-controller="CardCtrl">
              <div class="no-text">NOPE</div>
              <img ng-src="{{card.image}}" />
              <div class="yes-text">LIKE</div>
            </div>
          </td-card>
        </td-cards>
      </ion-pane>
    </div>
    <script>
      angular
        .module('starter', ['ionic', 'ionic.contrib.ui.tinderCards'])

        .directive('noScroll', function ($document) {
          return {
            restrict: 'A',
            link: function ($scope, $element, $attr) {
              $document.on('touchmove', function (e) {
                e.preventDefault();
              });
            },
          };
        })

        .controller('CardsCtrl', function ($scope, TDCardDelegate) {
          console.log('CARDS CTRL');
          var cardTypes = [
            {
              image:
                './img/test_img.jpg',
            },
            {
              image:
                './img/test_img.jpg',
            },
            {
              image: './img/test_img.jpg',
            },
            {
              image:
                './img/test_img.jpg',
            },
          ];

          $scope.cards = Array.prototype.slice.call(cardTypes, 0);

          $scope.cardDestroyed = function (index) {
            $scope.cards.splice(index, 1);
          };

          $scope.addCard = function () {
            var newCard = cardTypes[Math.floor(Math.random() * cardTypes.length)];
            newCard.id = Math.random();
            $scope.cards.push(angular.extend({}, newCard));
          };
        })

        .controller('CardCtrl', function ($scope, TDCardDelegate) {
          $scope.cardSwipedLeft = function (index) {
            console.log('LEFT SWIPE');
            $scope.addCard();
          };
          $scope.cardSwipedRight = function (index) {
            console.log('RIGHT SWIPE');
            $scope.addCard();
          };
        });
    </script>
  </body>
</html>
